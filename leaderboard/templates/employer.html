{% extends "base.html" %}
{% load i18n %}
{% load staticfiles %}

{% block title %}{{company.name}} Info{% endblock %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/cssplot.full.css' %}">
<link
    href="http://cdn.pydata.org/bokeh/release/bokeh-0.12.3.min.css"
    rel="stylesheet" type="text/css">
<link
    href="http://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.3.min.css"
    rel="stylesheet" type="text/css">

<script src="http://cdn.pydata.org/bokeh/release/bokeh-0.12.3.min.js"></script>
<script src="http://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.3.min.js"></script>
{{carbon_employer_script|safe}}
{{calories_employer_script|safe}}
{{change_script|safe}}

{% endblock %}

{% block body %}

{% load absolutely %}
{% load humanize %}

<div class="row clearfix">
    <div class="col-sm-12 column">
        <center>
          <h1><strong>{{employer.name}}</strong></h1>
          {% if company.nr_members %}
          <p>{{company.nr_members | intcomma}} team members eligible to participate</p>
          {% elif company.nr_employees %}
          <p>{{company.nr_employees | intcomma}} employees eligible to participate</p>
          {% endif %}
        </center>
    </div>
</div>

<div class="col-sm-12 column">
  <div>

    <!-- tabs -->
    <ul class="nav nav-pills" role="tablist">
      <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="pill">Home</a></li>
      <li role="presentation"><a href="#statistics" aria-controls="statistics" role="tab" data-toggle="pill">Statistics</a></li>
      <li role="presentation"><a href="#individual_surveys" aria-controls="individual_surveys" role="tab" data-toggle="pill">Individual Surveys</a></li>
      <li role="presentation"><a href="#comments" aria-controls="comments" role="tab" data-toggle="pill">Comments</a></li>
    </ul>

    <!-- data -->
    <div class="tab-content">

      <div role="tabpanel" class="tab-pane active" id="home">
        <h1>Welcome, {{employer.name}}!</h1>
	  <p style="font-size:160%">Here, you will find overall statistics on your company, as well as survey data from individual employees (if they chose to share with you). Thank you for participating in Walk/Ride Day!<p>
      </div>
      <div role="tabpanel" class="tab-pane" id="statistics">
	<div class="container">
          <ul class="nav nav-tabs">
			<li class="active">
			  {% for month in months %}
				{% if month = current_month %}
				  <li class="active"><a href="#{{month}}" data-toggle="tab">{{month}}</a></li>
				{% else %}
				  <li><a href="#{{month}}" data-toggle="tab">{{month}}</a></li>
				{% endif %}
			  {% endfor %}
			</li>
		  </ul>

		  <div class="col-sm-6 column">
		    <div class="tab-content ">
			  {% for month, data in all_months_data.items %}
			  {% if month = current_month %}
			  <div class="tab-pane active" id="{{month}}">
		      {% else %}
			  <div class="tab-pane" id="{{month}}">
		      {% endif %}

				<div class="container">
				  <h1>Statistics for {{month}}</h1>
				  <h2>{{data.employer_info.num_checkins}}</h2><h4>Check-Ins ({{data.employer_info.percent_participation | floatformat:"0" }}% Participation)</h4>
				  <h2>{{data.employer_info.total_calories | floatformat:"0" }} kcal</h2><h4>Total Calories Burned on Walk-Ride Day</h4>
				  <h2>{{data.employer_info.total_carbon | floatformat:"0" }} kg</h2><h4>Total CO2 Emitted on Walk-Ride Day</h4>
				  <h2>{{data.employer_info.total_C02 | floatformat:"0" }} kg</h2><h4>Total CO2 Saved On Walk-Ride Day </h4>(Compared to Only Driving Alone On a Normal Day)
				  <h2>{{data.employer_info.total_calories_n | floatformat:"0" }} kcal</h2><h4>Total Calories Burned on a Normal Day</h4>
				  <h2>{{data.employer_info.total_carbon_n | floatformat:"0" }} kg</h2><h4>Total CO2 Emitted on a Normal Day</h4>
          <br>
				  <h4>Walk Ride Day Commute</h4>
				  <table class="table table-hover table-bordered" style="width:40%">
					<tr><th>Mode</th><th>Number of People</th><th>Duration</th><th>Calories Burned</th><th>Carbon Dioxide Emitted</th></tr>
					{% for mode, leg in data.employer_legs_wr.items %}
					<tr><td>{{mode}}</td><td>{{leg.people}}</td><td>{{leg.duration | floatformat:"0" }} min</td>
					  <td>{{leg.calories | floatformat:"0" }} kcal</td><td>{{leg.carbon | floatformat:"0" }} kg</td></tr>
					{% endfor %}
				  </table>
				  <h4>Normal Commute</h4>
				  <table class="table table-hover table-bordered" style="width:40%">
					<tr><th>Mode</th><th>Number of People</th><th>Duration</th><th>Calories Burned</th><th>Carbon Dioxide Emitted</th></tr>
					{% for mode, leg in data.employer_legs_n.items %}
		  			  <tr><td>{{mode}}</td><td>{{leg.people}}</td><td>{{leg.duration | floatformat:"0" }} min</td>
						<td>{{leg.calories | floatformat:"0" }} kcal</td><td>{{leg.carbon | floatformat:"0" }} kg</td></tr>
					{% endfor %}
				  </table>
				</div>

			  </div>
			  {% endfor %}

		    </div>
		  </div>

		  <div class="col-sm-6 column">
		    <br>
		    <h1>Cumulative Statistics for {{year}}</h1>
		    <h2>{{cumulative.num_checkins}}</h2><h4>Check-Ins</h4>
		    <h2>{{cumulative.calories_wr | floatformat:"0" }} kcal</h2><h4>Total Calories Burned on Walk-Ride Day</h4>
		    <h2>{{cumulative.carbon_wr | floatformat:"0" }} kg</h2><h4>Total CO2 Emitted on Walk-Ride Day</h4>
		    <h2>{{cumulative.carbon_saved | floatformat:"0" }} kg</h2><h4>Total CO2 Saved On Walk-Ride Day </h4>(Compared to Only Driving Alone On a Normal Day)
		    <h2>{{cumulative.calories_n | floatformat:"0" }} kcal</h2><h4>Total Calories Burned on a Normal Day</h4>
		    <h2>{{cumulative.carbon_n | floatformat:"0" }} kg</h2><h4>Total CO2 Emitted on a Normal Day</h4>
        <br>
		    <h4>Walk Ride Day Commute</h4>
		    <table class="table table-hover table-bordered" style="width:40%">
			  <tr><th>Mode</th><th>Number of People</th><th>Duration</th><th>Calories Burned</th><th>Carbon Dioxide Emitted</th></tr>
			  {% for mode, leg in cumulative.all_legs_wr.items %}
			  <tr><td>{{mode}}</td><td>{{leg.people}}</td><td>{{leg.duration | floatformat:"0" }} min</td>
				  <td>{{leg.calories | floatformat:"0" }} kcal</td><td>{{leg.carbon | floatformat:"0" }} kg</td></tr>
			  {% endfor %}
		    </table>
		    <h4>Normal Commute</h4>
		    <table class="table table-hover table-bordered" style="width:40%">
			  <tr><th>Mode</th><th>Number of People</th><th>Duration</th><th>Calories Burned</th><th>Carbon Dioxide Emitted</th></tr>
			  {% for mode, leg in cumulative.all_legs_n.items %}
			    <tr><td>{{mode}}</td><td>{{leg.people}}</td><td>{{leg.duration | floatformat:"0" }} min</td>
					<td>{{leg.calories | floatformat:"0" }} kcal</td><td>{{leg.carbon | floatformat:"0" }} kg</td></tr>
			  {% endfor %}
		    </table>
		  </div>
	    </div>

	    <div class="container">
	      {{carbon_employer_div|safe}}<br>
		  {{calories_employer_div|safe}}<br>
	      {{change_div|safe}}
	    </div>
      </div>

      <div role="tabpanel" class="tab-pane" id="individual_surveys">

		<div class="container">
      <h3><font color="green">GREEN</font>: positive (healthy and/or green) change</h3><br>

		  <ul class="nav nav-tabs">
			<li class="active">
			  {% for month in months %}
				{% if month = current_month %}
				<li class="active"><a href="#{{month}}survey" data-toggle="tab">{{month}}</a></li>
				{% else %}
				<li><a href="#{{month}}survey" data-toggle="tab">{{month}}</a></li>
				{% endif %}
			  {% endfor %}
				<li><a href="#cumulativesurvey" data-toggle="tab">All Months for {{year}}</a></li>
			</li>
		  </ul>

		  <div class="tab-content ">
			{% for month, data in all_months_data.items %}

	        {% if month = current_month %}
	        <div class="tab-pane active" id="{{month}}survey">
	        {% else %}
	        <div class="tab-pane" id="{{month}}survey">
	        {% endif %}

	          <div id="letters" class="container">
	      		<ul class="nav nav-tabs">
				  <li class="active">
		  			{% for letter in letters %}
		  			<li><a href="#{{letter}}{{month}}" data-toggle="tab">{{letter}}</a></li>
		  			{% endfor %}
		  			<li class="active"><a href="#show_all{{month}}" data-toggle="tab">Show All</a></li>
		 		  </li>
	       		</ul>

	       		<div class="tab-content ">
		
	         	  {% for letter, employees in data.employees_by_letter.items %}
		   		  <div class="tab-pane" id="{{letter}}{{month}}">
		     		<div class="tabbable">
		       		  <ul class="nav nav-pills nav-stacked col-md-3">
			 		  {% for employee in employees %}
		         		<li><a href="#{{employee.id}}{{month}}" data-toggle="tab"><h3 style="color: {{employee.color}}">{{employee.last}}, {{employee.first}}</h3></a></li>
			 		  {% endfor %}
					  </ul>

		       		  <div class="tab-content col-md-9">
			 	        {% for employee in employees %}
		                <div class="tab-pane" id="{{employee.id}}{{month}}">
			 			  <h3>{{employee.last}}, {{employee.first}}</h3>
			 			  <table class="table">
                            <tr><th>Email</th><td>{{employee.email}}</td></tr>
                            <tr><th>Total Carbon Change</th><td>{{employee.carbon_change | floatformat:"0" }} kg</td></tr>
                            <tr><th>Total Calorie Change</th><td>{{employee.calorie_change | floatformat:"0" }} kcal</td></tr>
                            <tr><th>Change Type</th><td>{{employee.change_type}}</td></tr>
                          </table>
                          <h4>Walk Ride Day Commute</h4>
                          <table class="table table-hover table-bordered">
                            <thead>
                              <tr>
                                <th></th>
                                {% for dir in employee.leg_dirs_wrd %}
                                <th>{{dir}}</th>
                                {% endfor %}
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th scope="row">Mode</th>
                                {% for mode in employee.leg_modes_wrd %}
                                <td>{{mode}}</td>
                                {% endfor %}
                              </tr>
                              <tr>
                                <th scope="row">Duration</th>
                                {% for min in employee.leg_mins_wrd %}
                                <td>{{min | floatformat:"0" }} min</td>
                                {% endfor %}
                              </tr>
                              <tr>
                              <th scope="row">Calories Burned</th>
                              {% for cal in employee.leg_kcals_wrd %}
                              <td>{{cal | floatformat:"0" }} kcal</td>
                              {% endfor %}
                              </tr>
                              <tr>
                              <th scope="row">Carbon Dioxide Emitted</th>
                              {% for carb in employee.leg_carbon_wrd %}
                              <td>{{carb | floatformat:"0" }} kg</td>
                              {% endfor %}
                              </tr>
                            </tbody>
                          </table>
                          <h4>Normal Commute</h4>
                          <table class="table table-hover table-bordered">
                            <thead>
                            <tr>
                            <th></th>
                            {% for dir in employee.leg_dirs_n %}
                              <th>{{dir}}</th>
                            {% endfor %}
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                              <th scope="row">Mode</th>
                              {% for mode in employee.leg_modes_n %}
                            <td>{{mode}}</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Duration</th>
                              {% for min in employee.leg_mins_n %}
                            <td>{{min | floatformat:"0" }} min</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Calories Burned</th>
                              {% for cal in employee.leg_kcals_n %}
                            <td>{{cal | floatformat:"0" }} kcal</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Carbon Dioxide Emitted</th>
                              {% for carb in employee.leg_carbon_n %}
                            <td>{{carb | floatformat:"0" }} kg</td>
                              {% endfor %}
                            </tr>
                            </tbody>
                          </table>
            			  <hr>
			            </div>
			            {% endfor %}
                      </div>
                    </div>
                  </div>
		          {% endfor %}

            	  <div class="tab-pane active" id="show_all{{month}}">
		            <div class="tabbable">
                      <ul class="nav nav-pills nav-stacked col-md-3">
                      {% for letter, employees in data.employees_by_letter.items %}
                      {% for employee in employees %}
                        <li><a href="#all{{employee.id}}{{month}}" data-toggle="tab"><h4 style="color: {{employee.color}}">{{employee.last}}, {{employee.first}}</h4></a></li>
                      {% endfor %}
                      {% endfor %}
                      </ul>

                      <div class="tab-content col-md-9">
                      {% for letter, employees in data.employees_by_letter.items %}
                      {% for employee in employees %}
                        <div class="tab-pane" id="all{{employee.id}}{{month}}">
                          <h3>{{employee.last}}, {{employee.first}}</h3>
                          <table class="table">
                          <tr><th>Email</th><td>{{employee.email}}</td></tr>
                          <tr><th>Total Carbon Change</th><td>{{employee.carbon_change | floatformat:"0" }} kg</td></tr>
                          <tr><th>Total Calorie Change</th><td>{{employee.calorie_change | floatformat:"0" }} kcal</td></tr>
                          <tr><th>Change Type</th><td>{{employee.change_type}}</td></tr>
                          </table>
			              <h4>Walk Ride Day Commute</h4>
                          <table class="table table-hover table-bordered">
                          <thead>
                            <tr>
                            <th></th>
                            {% for dir in employee.leg_dirs_wrd %}
                              <th>{{dir}}</th>
                            {% endfor %}
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <th scope="row">Mode</th>
                              {% for mode in employee.leg_modes_wrd %}
                            <td>{{mode}}</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Duration</th>
                              {% for min in employee.leg_mins_wrd %}
                            <td>{{min | floatformat:"0" }} min</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Calories Burned</th>
                              {% for cal in employee.leg_kcals_wrd %}
                            <td>{{cal | floatformat:"0" }} kcal</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Carbon Dioxide Emitted</th>
                              {% for carb in employee.leg_carbon_wrd %}
                            <td>{{carb | floatformat:"0" }} kg</td>
                              {% endfor %}
                            </tr>
                          </tbody>
                          </table>
			              <h4>Normal Commute</h4>
                          <table class="table table-hover table-bordered">
                          <thead>
                            <tr>
                            <th></th>
                            {% for dir in employee.leg_dirs_n %}
                              <th>{{dir}}</th>
                            {% endfor %}
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <th scope="row">Mode</th>
                              {% for mode in employee.leg_modes_n %}
                            <td>{{mode}}</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Duration</th>
                              {% for min in employee.leg_mins_n %}
                            <td>{{min | floatformat:"0" }} min</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Calories Burned</th>
                              {% for cal in employee.leg_kcals_n %}
                            <td>{{cal | floatformat:"0" }} kcal</td>
                              {% endfor %}
                            </tr>
                            <tr>
                              <th scope="row">Carbon Dioxide Emitted</th>
                              {% for carb in employee.leg_carbon_n %}
                            <td>{{carb | floatformat:"0" }} kg</td>
                              {% endfor %}
                            </tr>
                          </tbody>
                          </table>
			              <hr>
			            </div>
			            {% endfor %}
			            {% endfor %}
                      </div>
		            </div>
                  </div>  <!-- ends show all div -->
            	  
		        </div>  <!-- ends div class="tab-content "> -->

              </div>
	        </div>
            {% endfor %}



	        <div class="tab-pane" id="cumulativesurvey">

	          <div id="letters" class="container">
	      		<ul class="nav nav-tabs">
				  <li class="active">
		  			{% for letter in letters %}
		  			<li><a href="#{{letter}}cumulative" data-toggle="tab">{{letter}}</a></li>
		  			{% endfor %}
		  			<li class="active"><a href="#show_all_cumulative" data-toggle="tab">Show All</a></li>
		 		  </li>
	       		</ul>

	       		<div class="tab-content ">
		
	         	  {% for letter, employees in employees_totals_by_letter.items %}
		   		  <div class="tab-pane" id="{{letter}}cumulative">
		     		<div class="tabbable">
		       		  <ul class="nav nav-pills nav-stacked col-md-3">
			 		  {% for employee in employees %}
		         		<li><a href="#cumulative{{employee.id}}" data-toggle="tab"><h3 style="color: {{employee.color}}">{{employee.last}}, {{employee.first}}</h3></a></li>
			 		  {% endfor %}
					  </ul>

		       		  <div class="tab-content col-md-9">
			 	        {% for employee in employees %}
		                <div class="tab-pane" id="cumulative{{employee.id}}">
			 			  <h3>{{employee.last}}, {{employee.first}}</h3>
			 			  <table class="table">
                            <tr><th>Email</th><td>{{employee.email}}</td></tr>
                            <tr><th>Total Carbon Change</th><td>{{employee.carbon_change | floatformat:"0" }} kg</td></tr>
                            <tr><th>Total Calorie Change</th><td>{{employee.calorie_change | floatformat:"0" }} kcal</td></tr>
			    </table>
			    <h4>Walk Ride Day</h4>
			    <table class="table table-hover table-bordered">
				  <tr><th>Mode</th><th>Duration</th><th>Calories Burned</th><th>Carbon Dioxide Emitted</th></tr>
				  {% for leg in employee.legs_wr %}
				  <tr><td>{{leg.mode}}</td><td>{{leg.duration | floatformat:"0" }} min</td>
					  <td>{{leg.calories | floatformat:"0" }} kcal</td><td>{{leg.carbon | floatformat:"0" }} kg</td></tr>
				  {% endfor %}
			    </table>
			    <h4>Normal Commute</h4>
			    <table class="table table-hover table-bordered">
				  <tr><th>Mode</th><th>Duration</th><th>Calories Burned</th><th>Carbon Dioxide Emitted</th></tr>
				  {% for leg in employee.legs_n %}
				    <tr><td>{{leg.mode}}</td><td>{{leg.duration | floatformat:"0" }} min</td>
						<td>{{leg.calories | floatformat:"0" }} kcal</td><td>{{leg.carbon | floatformat:"0" }} kg</td></tr>
				  {% endfor %}
			    </table>
            			  <hr>
			            </div>
			            {% endfor %}
                      </div>
                    </div>
                  </div>
		          {% endfor %}

            	  <div class="tab-pane active" id="show_all_cumulative">
		            <div class="tabbable">
                      <ul class="nav nav-pills nav-stacked col-md-3">
                      {% for letter, employees in employees_totals_by_letter.items %}
                      {% for employee in employees %}
                        <li><a href="#cumulativeall{{employee.id}}" data-toggle="tab"><h4 style="color: {{employee.color}}">{{employee.last}}, {{employee.first}}</h4></a></li>
                      {% endfor %}
                      {% endfor %}
                      </ul>

                      <div class="tab-content col-md-9">
                      {% for letter, employees in employees_totals_by_letter.items %}
                      {% for employee in employees %}
                        <div class="tab-pane" id="cumulativeall{{employee.id}}">
                          <h3>{{employee.last}}, {{employee.first}}</h3>
                          <table class="table">
                          <tr><th>Email</th><td>{{employee.email}}</td></tr>
                          <tr><th>Total Carbon Change</th><td>{{employee.carbon_change | floatformat:"0" }} kg</td></tr>
                          <tr><th>Total Calorie Change</th><td>{{employee.calorie_change | floatformat:"0" }} kcal</td></tr>
			  </table>
			    <h4>Walk Ride Day Commute</h4>
			    <table class="table table-hover table-bordered">
				  <tr><th>Mode</th><th>Duration</th><th>Calories Burned</th><th>Carbon Dioxide Emitted</th></tr>
				  {% for leg in employee.legs_wr %}
				  <tr><td>{{leg.mode}}</td><td>{{leg.duration | floatformat:"0" }} min</td>
					  <td>{{leg.calories | floatformat:"0" }} kcal</td><td>{{leg.carbon | floatformat:"0" }} kg</td></tr>
				  {% endfor %}
			    </table>
			    <h4>Normal Commute</h4>
			    <table class="table table-hover table-bordered">
				  <tr><th>Mode</th><th>Duration</th><th>Calories Burned</th><th>Carbon Dioxide Emitted</th></tr>
				  {% for leg in employee.legs_n %}
				    <tr><td>{{leg.mode}}</td><td>{{leg.duration | floatformat:"0" }} min</td>
						<td>{{leg.calories | floatformat:"0" }} kcal</td><td>{{leg.carbon | floatformat:"0" }} kg</td></tr>
				  {% endfor %}
			    </table>
			              <hr>
			            </div>
			            {% endfor %}
			            {% endfor %}
                      </div>
		            </div>
                  </div>  <!-- ends show all div for cumulative -->

	  </div>
	  </div> 
	  </div> 
        </div>
        </div>
      </div>

      <div role="tabpanel" class="tab-pane" id="comments">

	<div class="container">

		  <ul class="nav nav-tabs">
			<li class="active">
			  {% for month in months %}
				{% if month = current_month %}
				<li class="active"><a href="#{{month}}question" data-toggle="tab">{{month}}</a></li>
				{% else %}
				<li><a href="#{{month}}question" data-toggle="tab">{{month}}</a></li>
				{% endif %}
			  {% endfor %}
			</li>
		  </ul>

		  <div class="tab-content ">
			{% for month, data in all_months_data.items %}

	        {% if month = current_month %}
	        <div class="tab-pane active" id="{{month}}question">
	        {% else %}
	        <div class="tab-pane" id="{{month}}question">
	        {% endif %}

        <h1>Question of the Month: <i>{{data.question}}</i></h1>
        <br><br>
        {% for comment in data.comments %}
            {{comment}} <hr>
        {% endfor %}
	</div>
       {% endfor %}
      </div>
      </div>
      </div>

    </div>
  </div>
</div>

{% endblock %}
